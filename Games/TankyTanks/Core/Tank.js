// Generated by CoffeeScript 1.12.1
(function() {
  var Barrel, Track, exports,
    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

  exports = this;

  exports.Tank = (function(superClass) {
    extend(Tank, superClass);

    Tank.prototype.controller = null;

    Tank.prototype.moveSpeed = 0.2;

    Tank.prototype.barrel = null;

    function Tank(game, x, y) {
      Tank.__super__.constructor.call(this, game, x, y);
      this.Wrap();
      this.Bind.Texture("tank-green");
      this.barrel = new Barrel(this);
    }

    Tank.Load = function(game) {
      game.Load.Texture("Assets/Art/PNG/Tanks/tankGreen_outline.png", "tank-green");
      game.Load.Texture("Assets/Art/PNG/Tanks/barrelGreen_outline.png", "tank-barrel-green");
      return game.Load.Texture("Assets/Art/PNG/Tanks/tracksSmall.png", "track");
    };

    Tank.prototype.Update = function() {
      var t;
      Tank.__super__.Update.call(this);
      if (this.Body.distance >= (this.rectangle.width * 0.9)) {
        t = new Track(this);
        return this.Body.distance = 0;
      }
    };

    Tank.prototype.GiveControl = function(controller) {
      this.controller = controller;
      this.controller.tank = this;
      return this.game.Add(this.controller);
    };

    Tank.prototype.Shoot = function() {
      var b;
      return b = new Bullet(this);
    };

    return Tank;

  })(Torch.Sprite);

  Barrel = (function(superClass) {
    extend(Barrel, superClass);

    Barrel.prototype.shootDist = 100;

    function Barrel(tank) {
      this.tank = tank;
      Barrel.__super__.constructor.call(this, this.tank.game, this.tank.position.x, this.tank.position.y);
      this.Bind.Texture("tank-barrel-green");
      this.rotationOffset.y = -1 * this.rectangle.height / 4;
      this.shootPoint = new Torch.Shapes.Circle(this.game, 0, 0, 5, "green", "green");
      this.shootDist = this.rectangle.width * 2.5;
    }

    Barrel.prototype.Update = function() {
      var rot, x, y;
      Barrel.__super__.Update.call(this);
      this.PositionOnTank();
      rot = this.rotation - Math.PI / 2;
      x = (this.tank.position.x + this.tank.rectangle.width / 2) + Math.cos(rot) * this.shootDist;
      y = (this.tank.position.y + this.tank.rectangle.height / 2) + Math.sin(rot) * this.shootDist;
      return this.shootPoint.position.Set(x, y);
    };

    Barrel.prototype.PositionOnTank = function() {
      var x, y;
      x = this.tank.position.x + (this.tank.rectangle.width / 2) - this.rectangle.width / 2;
      y = this.tank.position.y + (this.tank.rectangle.height / 2) - this.rectangle.height / 2;
      return this.position.Set(x, y);
    };

    return Barrel;

  })(Torch.Sprite);

  Track = (function(superClass) {
    extend(Track, superClass);

    function Track(tank) {
      this.tank = tank;
      Track.__super__.constructor.call(this, this.tank.game, this.tank.position.x, this.tank.position.y);
      this.Bind.Texture("track");
      this.rotation = this.tank.rotation;
      this.drawIndex = this.tank.drawIndex - 1;
      this.game.Timer.SetFutureEvent(4000, (function(_this) {
        return function() {
          return _this.game.Tweens.Tween(_this, 1000).To({
            opacity: 0
          }).On("Finish", function() {
            return _this.Trash();
          });
        };
      })(this));
    }

    return Track;

  })(Torch.Sprite);

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGFuay5qcyIsInNvdXJjZVJvb3QiOiIuLlxcLi5cXC4uIiwic291cmNlcyI6WyJHYW1lc1xcVGFua3lUYW5rc1xcU3JjXFxUYW5rLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7QUFBQSxNQUFBLHNCQUFBO0lBQUE7OztFQUFBLE9BQUEsR0FBVTs7RUFFSixPQUFPLENBQUM7OzttQkFDVixVQUFBLEdBQVk7O21CQUNaLFNBQUEsR0FBVzs7bUJBQ1gsTUFBQSxHQUFROztJQUVLLGNBQUUsSUFBRixFQUFRLENBQVIsRUFBVyxDQUFYO01BQ1Qsc0NBQU8sSUFBUCxFQUFhLENBQWIsRUFBZ0IsQ0FBaEI7TUFFQSxJQUFDLENBQUEsSUFBRCxDQUFBO01BRUEsSUFBQyxDQUFBLElBQUksQ0FBQyxPQUFOLENBQWUsWUFBZjtNQUNBLElBQUMsQ0FBQSxNQUFELEdBQWMsSUFBQSxNQUFBLENBQVEsSUFBUjtJQU5MOztJQVViLElBQUMsQ0FBQSxJQUFELEdBQU8sU0FBQyxJQUFEO01BQ0gsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFWLENBQWtCLDRDQUFsQixFQUFnRSxZQUFoRTtNQUNBLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBVixDQUFrQiw4Q0FBbEIsRUFBa0UsbUJBQWxFO2FBQ0EsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFWLENBQWtCLHNDQUFsQixFQUEwRCxPQUExRDtJQUhHOzttQkFLUCxNQUFBLEdBQVEsU0FBQTtBQUNKLFVBQUE7TUFBQSwrQkFBQTtNQUNBLElBQUcsSUFBQyxDQUFBLElBQUksQ0FBQyxRQUFOLElBQWtCLENBQUUsSUFBQyxDQUFBLFNBQVMsQ0FBQyxLQUFYLEdBQW1CLEdBQXJCLENBQXJCO1FBQ0ksQ0FBQSxHQUFRLElBQUEsS0FBQSxDQUFPLElBQVA7ZUFDUixJQUFDLENBQUEsSUFBSSxDQUFDLFFBQU4sR0FBaUIsRUFGckI7O0lBRkk7O21CQU1SLFdBQUEsR0FBYSxTQUFFLFVBQUY7TUFDVCxJQUFDLENBQUEsVUFBRCxH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Q0FBcEQ7TUFFQSxJQUFDLENBQUEsSUFBSSxDQUFDLE9BQU4sQ0FBZSxPQUFmO01BRUEsSUFBQyxDQUFBLFFBQUQsR0FBWSxJQUFDLENBQUEsSUFBSSxDQUFDO01BQ2xCLElBQUMsQ0FBQSxTQUFELEdBQWEsSUFBQyxDQUFBLElBQUksQ0FBQyxTQUFOLEdBQWtCO01BRS9CLElBQUMsQ0FBQSxJQUFJLENBQUMsS0FBSyxDQUFDLGNBQVosQ0FBMkIsSUFBM0IsRUFBaUMsQ0FBQSxTQUFBLEtBQUE7ZUFBQSxTQUFBO2lCQUM3QixLQUFDLENBQUEsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFiLENBQW9CLEtBQXBCLEVBQXVCLElBQXZCLENBQTZCLENBQUMsRUFBOUIsQ0FBa0M7WUFBQSxPQUFBLEVBQVMsQ0FBVDtXQUFsQyxDQUE4QyxDQUFDLEVBQS9DLENBQWtELFFBQWxELEVBQTRELFNBQUE7bUJBQUcsS0FBQyxDQUFBLEtBQUQsQ0FBQTtVQUFILENBQTVEO1FBRDZCO01BQUEsQ0FBQSxDQUFBLENBQUEsSUFBQSxDQUFqQztJQVJTOzs7O0tBREcsS0FBSyxDQUFDO0FBL0QxQiIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydHMgPSB0aGlzXHJcblxyXG5jbGFzcyBleHBvcnRzLlRhbmsgZXh0ZW5kcyBUb3JjaC5TcHJpdGVcclxuICAgIGNvbnRyb2xsZXI6IG51bGwgICAgICAgICAgIyB0aGUgb2JqZWN0IHRoYXQgaXMgY29udHJvbGxpbmcgdGhlIHRhbmtcclxuICAgIG1vdmVTcGVlZDogMC4yICAgICAgICAgICAgIyB0aGUgbW92ZW1lbnQgdmVsb2NpdHkgb2YgdGhlIHRhbmtcclxuICAgIGJhcnJlbDogbnVsbCAgICAgICAgICAgICAgIyB0aGUgYmFycmVsIG9mIHRoZSB0YW5rXHJcblxyXG4gICAgY29uc3RydWN0b3I6ICggZ2FtZSwgeCwgeSApIC0+XHJcbiAgICAgICAgc3VwZXIoIGdhbWUsIHgsIHkgKVxyXG5cclxuICAgICAgICBAV3JhcCgpXHJcblxyXG4gICAgICAgIEBCaW5kLlRleHR1cmUoIFwidGFuay1ncmVlblwiIClcclxuICAgICAgICBAYmFycmVsID0gbmV3IEJhcnJlbCggQCApXHJcblxyXG5cclxuXHJcbiAgICBATG9hZDogKGdhbWUpIC0+XHJcbiAgICAgICAgZ2FtZS5Mb2FkLlRleHR1cmUoXCJBc3NldHMvQXJ0L1BORy9UYW5rcy90YW5rR3JlZW5fb3V0bGluZS5wbmdcIiwgXCJ0YW5rLWdyZWVuXCIpXHJcbiAgICAgICAgZ2FtZS5Mb2FkLlRleHR1cmUoXCJBc3NldHMvQXJ0L1BORy9UYW5rcy9iYXJyZWxHcmVlbl9vdXRsaW5lLnBuZ1wiLCBcInRhbmstYmFycmVsLWdyZWVuXCIpXHJcbiAgICAgICAgZ2FtZS5Mb2FkLlRleHR1cmUoXCJBc3NldHMvQXJ0L1BORy9UYW5rcy90cmFja3NTbWFsbC5wbmdcIiwgXCJ0cmFja1wiKVxyXG5cclxuICAgIFVwZGF0ZTogLT5cclxuICAgICAgICBzdXBlcigpXHJcbiAgICAgICAgaWYgQEJvZHkuZGlzdGFuY2UgPj0gKCBAcmVjdGFuZ2xlLndpZHRoICogMC45IClcclxuICAgICAgICAgICAgdCA9IG5ldyBUcmFjayggQCApXHJcbiAgICAgICAgICAgIEBCb2R5LmRpc3RhbmNlID0gMFxyXG5cclxuICAgIEdpdmVDb250cm9sOiAoIGNvbnRyb2xsZXIgKSAtPlxyXG4gICAgICAgIEBjb250cm9sbGVyID0gY29udHJvbGxlclxyXG4gICAgICAgIEBjb250cm9sbGVyLnRhbmsgPSBAXHJcbiAgICAgICAgQGdhbWUuQWRkKCBAY29udHJvbGxlciApXHJcblxyXG4gICAgU2hvb3Q6IC0+XHJcbiAgICAgICAgYiA9IG5ldyBCdWxsZXQoIEAgKVxyXG5cclxuY2xhc3MgQmFycmVsIGV4dGVuZHMgVG9yY2guU3ByaXRlXHJcbiAgICBzaG9vdERpc3Q6IDEwMFxyXG4gICAgY29uc3RydWN0b3I6IChAdGFuaykgLT5cclxuICAgICAgICBzdXBlciggQHRhbmsuZ2FtZSwgQHRhbmsucG9zaXRpb24ueCwgQHRhbmsucG9zaXRpb24ueSApXHJcbiAgICAgICAgQEJpbmQuVGV4dHVyZSggXCJ0YW5rLWJhcnJlbC1ncmVlblwiIClcclxuXHJcbiAgICAgICAgQHJvdGF0aW9uT2Zmc2V0LnkgPSAtMSAqIEByZWN0YW5nbGUuaGVpZ2h0IC8gNFxyXG4gICAgICAgIEBzaG9vdFBvaW50ID0gbmV3IFRvcmNoLlNoYXBlcy5DaXJjbGUoQGdhbWUsIDAsIDAsIDUsIFwiZ3JlZW5cIiwgXCJncmVlblwiKVxyXG4gICAgICAgIEBzaG9vdERpc3QgPSBAcmVjdGFuZ2xlLndpZHRoICogMi41XHJcblxyXG4gICAgVXBkYXRlOiAtPlxyXG4gICAgICAgIHN1cGVyKClcclxuXHJcbiAgICAgICAgQFBvc2l0aW9uT25UYW5rKClcclxuICAgICAgICByb3QgPSBAcm90YXRpb24gLSBNYXRoLlBJIC8gMlxyXG5cclxuICAgICAgICB4ID0gKEB0YW5rLnBvc2l0aW9uLnggKyBAdGFuay5yZWN0YW5nbGUud2lkdGgvMikgKyBNYXRoLmNvcyggcm90ICkgKiBAc2hvb3REaXN0XHJcbiAgICAgICAgeSA9IChAdGFuay5wb3NpdGlvbi55ICsgQHRhbmsucmVjdGFuZ2xlLmhlaWdodC8yKSArIE1hdGguc2luKCByb3QgKSAqIEBzaG9vdERpc3RcclxuXHJcbiAgICAgICAgQHNob290UG9pbnQucG9zaXRpb24uU2V0KCB4LCB5IClcclxuXHJcbiAgICBQb3NpdGlvbk9uVGFuazogLT5cclxuICAgICAgICB4ID0gQHRhbmsucG9zaXRpb24ueCArICggQHRhbmsucmVjdGFuZ2xlLndpZHRoIC8gMiApIC0gQHJlY3RhbmdsZS53aWR0aCAvIDJcclxuICAgICAgICB5ID0gQHRhbmsucG9zaXRpb24ueSArICggQHRhbmsucmVjdGFuZ2xlLmhlaWdodCAvIDIgKSAtIEByZWN0YW5nbGUuaGVpZ2h0IC8gMlxyXG5cclxuICAgICAgICBAcG9zaXRpb24uU2V0KCB4LCB5IClcclxuXHJcbmNsYXNzIFRyYWNrIGV4dGVuZHMgVG9yY2guU3ByaXRlXHJcbiAgICBjb25zdHJ1Y3RvcjogKEB0YW5rKSAtPlxyXG4gICAgICAgIHN1cGVyKCBAdGFuay5nYW1lLCBAdGFuay5wb3NpdGlvbi54LCBAdGFuay5wb3NpdGlvbi55IClcclxuXHJcbiAgICAgICAgQEJpbmQuVGV4dHVyZSggXCJ0cmFja1wiIClcclxuXHJcbiAgICAgICAgQHJvdGF0aW9uID0gQHRhbmsucm90YXRpb25cclxuICAgICAgICBAZHJhd0luZGV4ID0gQHRhbmsuZHJhd0luZGV4IC0gMVxyXG5cclxuICAgICAgICBAZ2FtZS5UaW1lci5TZXRGdXR1cmVFdmVudCA0MDAwLCA9PlxyXG4gICAgICAgICAgICBAZ2FtZS5Ud2VlbnMuVHdlZW4oIEAsIDEwMDAgKS5Ubyggb3BhY2l0eTogMCApLk9uIFwiRmluaXNoXCIsID0+IEBUcmFzaCgpXHJcbiJdfQ==
//# sourceURL=C:\dev\Torch\Games\TankyTanks\Src\Tank.coffee