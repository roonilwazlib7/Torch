// Generated by CoffeeScript 1.12.1
(function() {
  var Controller, exports,
    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

  exports = this;

  Controller = (function(superClass) {
    extend(Controller, superClass);

    Controller.prototype.tank = null;

    Controller.prototype.timestamp_bulletFired = 0;

    Controller.prototype.moveRight = false;

    Controller.prototype.moveLeft = false;

    Controller.prototype.moveUp = false;

    Controller.prototype.moveDown = false;

    Controller.prototype.moving = false;

    function Controller(game1) {
      this.game = game1;
    }

    Controller.prototype.Update = function() {
      this.UpdateMovement();
      this.UpdateBarrel();
      return this.UpdateShooting();
    };

    Controller.prototype.UpdateBarrel = function() {
      throw new Error("Controllers must update movement");
    };

    Controller.prototype.UpdateBarrel = function() {
      throw new Error("Controllers must update the barrel");
    };

    Controller.prototype.UpdateShooting = function() {
      throw new Error("Controllers must update shooting");
    };

    return Controller;

  })(Torch.GameThing);

  exports.KeyBoardController = (function(superClass) {
    extend(KeyBoardController, superClass);

    function KeyBoardController() {
      return KeyBoardController.__super__.constructor.apply(this, arguments);
    }

    KeyBoardController.prototype.UpdateMovement = function() {
      var keys;
      keys = this.game.Keys;
      this.moveRight = keys.D.down;
      this.moveLeft = keys.A.down;
      this.moveUp = keys.W.down;
      this.moveDown = keys.S.down;
      return this.moving = this.moveRight || this.moveLeft || this.moveUp || this.moveDown;
    };

    KeyBoardController.prototype.UpdateBarrel = function() {
      var m, v;
      v = this.tank.barrel.position.Clone();
      v.x += this.tank.barrel.rectangle.width / 2;
      v.y += this.tank.barrel.rectangle.height / 2;
      m = new Torch.Vector(this.game.Mouse.x, this.game.Mouse.y);
      v.SubtractVector(m);
      v.Normalize();
      return this.tank.barrel.rotation = -v.angle;
    };

    return KeyBoardController;

  })(Controller);

  exports.GamePadController_Xbox360 = (function(superClass) {
    extend(GamePadController_Xbox360, superClass);

    function GamePadController_Xbox360(gamePad) {
      this.gamePad = gamePad;
    }

    GamePadController_Xbox360.prototype.UpdateMovement = function() {
      var buttons, rotation, sticks;
      buttons = this.gamePad.buttons;
      sticks = this.gamePad.sticks;
      rotation = this.tank.rotation;
      this.tank.Body.velocity.Set(sticks.LeftStick.horizontalAxis, sticks.LeftStick.verticalAxis);
      this.tank.Body.velocity.MultiplyScalar(this.tank.moveSpeed);
      if (this.tank.Body.velocity.magnitude > 0) {
        rotation = this.tank.Body.velocity.angle + Math.PI / 2;
      }
      return this.tank.rotation = rotation;
    };

    GamePadController_Xbox360.prototype.UpdateBarrel = function() {
      var rotation;
      rotation = this.tank.barrel.rotation;
      if (Math.abs(this.gamePad.sticks.RightStick.verticalAxis) > 0 || Math.abs(this.gamePad.sticks.RightStick.horizontalAxis) > 0) {
        rotation = Math.atan2(this.gamePad.sticks.RightStick.verticalAxis, this.gamePad.sticks.RightStick.horizontalAxis);
        rotation += Math.PI / 2;
      }
      return this.tank.barrel.rotation = rotation;
    };

    GamePadController_Xbox360.prototype.UpdateShooting = function() {
      var game;
      game = this.tank.game;
      if (this.gamePad.buttons.RightTrigger.down && (game.time - this.timestamp_bulletFired) > 400) {
        this.timestamp_bulletFired = game.time;
        return this.tank.Shoot();
      }
    };

    return GamePadController_Xbox360;

  })(Controller);

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29udHJvbGxlci5qcyIsInNvdXJjZVJvb3QiOiIuLlxcLi5cXC4uIiwic291cmNlcyI6WyJHYW1lc1xcVGFua3lUYW5rc1xcU3JjXFxDb250cm9sbGVyLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7QUFBQSxNQUFBLG1CQUFBO0lBQUE7OztFQUFBLE9BQUEsR0FBVTs7RUFFSjs7O3lCQUNGLElBQUEsR0FBTTs7eUJBQ04scUJBQUEsR0FBdUI7O3lCQUN2QixTQUFBLEdBQVc7O3lCQUNYLFFBQUEsR0FBVTs7eUJBQ1YsTUFBQSxHQUFROzt5QkFDUixRQUFBLEdBQVU7O3lCQUNWLE1BQUEsR0FBUTs7SUFFSyxvQkFBQyxLQUFEO01BQUMsSUFBQyxDQUFBLE9BQUQ7SUFBRDs7eUJBRWIsTUFBQSxHQUFRLFNBQUE7TUFDSixJQUFDLENBQUEsY0FBRCxDQUFBO01BQ0EsSUFBQyxDQUFBLFlBQUQsQ0FBQTthQUNBLElBQUMsQ0FBQSxjQUFELENBQUE7SUFISTs7eUJBS1IsWUFBQSxHQUFjLFNBQUE7QUFBRyxZQUFVLElBQUEsS0FBQSxDQUFPLGtDQUFQO0lBQWI7O3lCQUVkLFlBQUEsR0FBYyxTQUFBO0FBQUcsWUFBVSxJQUFBLEtBQUEsQ0FBTyxvQ0FBUDtJQUFiOzt5QkFFZCxjQUFBLEdBQWdCLFNBQUE7QUFBRyxZQUFVLElBQUEsS0FBQSxDQUFPLGtDQUFQO0lBQWI7Ozs7S0FwQkssS0FBSyxDQUFDOztFQXNCekIsT0FBTyxDQUFDOzs7Ozs7O2lDQUVWLGNBQUEsR0FBZ0IsU0FBQTtBQUNaLFVBQUE7TUFBQSxJQUFBLEdBQU8sSUFBQyxDQUFBLElBQUksQ0FBQztNQUViLElBQUMsQ0FBQSxTQUFELEdBQWEsSUFBSSxDQUFDLENBQUMsQ0FBQztNQUNwQixJQUFDLENBQUEsUUFBRCxHQUFZLElBQUksQ0FBQyxDQUFDLENBQUM7TUFDbkIsSUFBQyxDQUFBLE1BQUQsR0FBVSxJQUFJLENBQUMsQ0FBQyxDQUFDO01BQ2pCLElBQUMsQ0FBQSxRQUFELEdBQVksSUFBSSxDQUFDLENBQUMsQ0FBQzthQUVuQixJQUFDLENBQUEsTUFBRCxHQUFZLElBQUMsQ0FBQSxTQUFELElBQWMsSUFBQyxDQUFBLFFBQWYsSUFBMkIsSUFBQyxDQUFBLE1BQTVCLElBQXNDLElBQUMsQ0FBQTtJQVJ2Qzs7aUNBVWhCLFlBQUEsR0FBYyxTQUFBO0FBQ1YsVUFBQTtNQUFBLENBQUEsR0FBSSxJQUFDLENBQUEsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsS0FBdEIsQ0FBQTtNQUNKLENBQUMsQ0FBQyxDQUFGLElBQU8sSUFBQyxDQUFBLElBQUksQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLEtBQXZCLEdBQStCO01BQ3RDLENBQUMsQ0FBQyxDQUFGLElBQU8sSUFBQyxDQUFBLElBQUksQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLE1BQXZCLEdBQStCO01BRXRDLENBQUEsR0FBUSxJQUFBLEtBQUssQ0FBQyxNQUFOLENBQWMsSUFBQyxDQUFBLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBMUIsRUFBNkIsSUFBQyxDQUFBLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBekM7TUFFUixDQUFDLENBQUMsY0FBRixDQUFrQixDQUFsQjtNQUNBLENBQUMsQ0FBQyxTQUFGLENBQUE7YUFDQSxJQUFDLENBQUEsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFiLEdBQXdCLENBQUMsQ0FBQyxDQUFDO0lBVGpCOzs7O0tBWnVCOztFQXdCbkMsT0FBTyxDQUFDOzs7SUFDRyxtQ0FBQyxPQUFEO01BQUMsSUFBQyxDQUFBLFVBQUQ7SUFBRDs7d0NBRWIsY0FBQSxHQUFnQixTQUFBO0FBQ1osVUFBQTtNQUFBLE9BQUEsR0FBVSxJQUFDLENBQUEsT0FBTyxDQUFDO01BQ25CLE1BQUEsR0FBUyxJQUFDLENBQUEsT0FBTyxDQUFDO01BQ2xCLFFBQUEsR0FBVyxJQUFDLENBQUEsSUFBSSxDQUFDO01BRWpCLElBQUMsQ0FBQSxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFwQixDQUF5QixNQUFNLENBQUMsU0FBUyxDQUFDLGNBQTFDLEVBQTBELE1BQU0sQ0FBQyxTQUFTLENBQUMsWUFBM0U7TUFDQSxJQUFDLENBQUEsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsY0FBcEIsQ0FBb0MsSUFBQyxDQUFBLElBQUksQ0FBQyxTQUExQztNQUVBLElBQUcsSUFBQyxDQUFBLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLFNBQXBCLEdBQWdDLENBQW5DO1FBQ0ksUUFBQSxHQUFXLElBQUMsQ0FBQSxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFwQixHQUE0QixJQUFJLENBQUMsRUFBTCxHQUFVLEVBRHJEOzthQUdBLElBQUMsQ0FBQSxJQUFJLENBQUMsUUFBTixHQUFpQjtJQVhMOzt3Q0FhaEIsWUFBQSxHQUFjLFNBQUE7QUFDVixVQUFBO01BQUEsUUFBQSxHQUFXLElBQUMsQ0FBQSxJQUFJLENBQUMsTUFBTSxDQUFDO01BRXhCLElBQUcsSUFBSSxDQUFDLEdBQUwsQ0FBUyxJQUFDLENBQUEsT0FBTyxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsWUFBcEMsQ0FBQSxHQUFvRCxDQUFwRCxJQUF5RCxJQUFJLENBQUMsR0FBTCxDQUFTLElBQUMsQ0FBQSxPQUFPLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxjQUFwQyxDQUFBLEdBQXNELENBQWxIO1FBQ0ksUUFBQSxHQUFXLElBQUksQ0FBQyxLQUFMLENBQVksSUFBQyxDQUFBLE9BQU8sQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLFlBQXZDLEVBQXFELElBQUMsQ0FBQSxPQUFPLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxjQUFoRjtRQUNYLFFBQUEsSUFBWSxJQUFJLENBQUMsRUFBTCxHQUFVLEVBRjFCOzthQUlBLElBQUMsQ0FBQSxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQWIsR0FBd0I7SUFQZDs7d0NBU2QsY0FBQSxHQUFnQixTQUFBO0FBQ1osVUFBQTtNQUFBLElBQUEsR0FBTyxJQUFDLENBQUEsSUFBSSxDQUFDO01BQ2IsSUFBRyxJQUFDLENBQUEsT0FBTyxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsSUFBOUIsSUFBdUMsQ0FBRSxJQUFJLENBQUMsSUFBTCxHQUFZLElBQUMsQ0FBQSxxQkFBZixDQUFBLEdBQXlDLEdBQW5GO1FBQ0ksSUFBQyxDQUFBLHFCQUFELEdBQXlCLElBQUksQ0FBQztlQUM5QixJQUFDLENBQUEsSUFBSSxDQUFDLEtBQU4sQ0FBQSxFQUZKOztJQUZZOzs7O0tBekI0QjtBQWhEaEQiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnRzID0gdGhpc1xyXG5cclxuY2xhc3MgQ29udHJvbGxlciBleHRlbmRzIFRvcmNoLkdhbWVUaGluZ1xyXG4gICAgdGFuazogbnVsbFxyXG4gICAgdGltZXN0YW1wX2J1bGxldEZpcmVkOiAwXHJcbiAgICBtb3ZlUmlnaHQ6IGZhbHNlXHJcbiAgICBtb3ZlTGVmdDogZmFsc2VcclxuICAgIG1vdmVVcDogZmFsc2VcclxuICAgIG1vdmVEb3duOiBmYWxzZVxyXG4gICAgbW92aW5nOiBmYWxzZVxyXG5cclxuICAgIGNvbnN0cnVjdG9yOiAoQGdhbWUpIC0+XHJcblxyXG4gICAgVXBkYXRlOiAtPlxyXG4gICAgICAgIEBVcGRhdGVNb3ZlbWVudCgpXHJcbiAgICAgICAgQFVwZGF0ZUJhcnJlbCgpXHJcbiAgICAgICAgQFVwZGF0ZVNob290aW5nKClcclxuXHJcbiAgICBVcGRhdGVCYXJyZWw6IC0+IHRocm93IG5ldyBFcnJvciggXCJDb250cm9sbGVycyBtdXN0IHVwZGF0ZSBtb3ZlbWVudFwiIClcclxuXHJcbiAgICBVcGRhdGVCYXJyZWw6IC0+IHRocm93IG5ldyBFcnJvciggXCJDb250cm9sbGVycyBtdXN0IHVwZGF0ZSB0aGUgYmFycmVsXCIgKVxyXG5cclxuICAgIFVwZGF0ZVNob290aW5nOiAtPiB0aHJvdyBuZXcgRXJyb3IoIFwiQ29udHJvbGxlcnMgbXVzdCB1cGRhdGUgc2hvb3RpbmdcIiApXHJcblxyXG5jbGFzcyBleHBvcnRzLktleUJvYXJkQ29udHJvbGxlciBleHRlbmRzIENvbnRyb2xsZXJcclxuXHJcbiAgICBVcGRhdGVNb3ZlbWVudDogLT5cclxuICAgICAgICBrZXlzID0gQGdhbWUuS2V5c1xyXG5cclxuICAgICAgICBAbW92ZVJpZ2h0ID0ga2V5cy5ELmRvd25cclxuICAgICAgICBAbW92ZUxlZnQgPSBrZXlzLkEuZG93blxyXG4gICAgICAgIEBtb3ZlVXAgPSBrZXlzLlcuZG93blxyXG4gICAgICAgIEBtb3ZlRG93biA9IGtleXMuUy5kb3duXHJcblxyXG4gICAgICAgIEBtb3ZpbmcgPSAoIEBtb3ZlUmlnaHQgb3IgQG1vdmVMZWZ0IG9yIEBtb3ZlVXAgb3IgQG1vdmVEb3duIClcclxuXHJcbiAgICBVcGRhdGVCYXJyZWw6IC0+XHJcbiAgICAgICAgdiA9IEB0YW5rLmJhcnJlbC5wb3NpdGlvbi5DbG9uZSgpXHJcbiAgICAgICAgdi54ICs9IEB0YW5rLmJhcnJlbC5yZWN0YW5nbGUud2lkdGggLyAyXHJcbiAgICAgICAgdi55ICs9IEB0YW5rLmJhcnJlbC5yZWN0YW5nbGUuaGVpZ2h0IC8yXHJcblxyXG4gICAgICAgIG0gPSBuZXcgVG9yY2guVmVjdG9yKCBAZ2FtZS5Nb3VzZS54LCBAZ2FtZS5Nb3VzZS55IClcclxuXHJcbiAgICAgICAgdi5TdWJ0cmFjdFZlY3RvciggbSApXHJcbiAgICAgICAgdi5Ob3JtYWxpemUoKVxyXG4gICAgICAgIEB0YW5rLmJhcnJlbC5yb3RhdGlvbiA9IC12LmFuZ2xlXHJcblxyXG5cclxuY2xhc3MgZXhwb3J0cy5HYW1lUGFkQ29udHJvbGxlcl9YYm94MzYwIGV4dGVuZHMgQ29udHJvbGxlclxyXG4gICAgY29uc3RydWN0b3I6IChAZ2FtZVBhZCkgLT5cclxuXHJcbiAgICBVcGRhdGVNb3ZlbWVudDogLT5cclxuICAgICAgICBidXR0b25zID0gQGdhbWVQYWQuYnV0dG9uc1xyXG4gICAgICAgIHN0aWNrcyA9IEBnYW1lUGFkLnN0aWNrc1xyXG4gICAgICAgIHJvdGF0aW9uID0gQHRhbmsucm90YXRpb25cclxuXHJcbiAgICAgICAgQHRhbmsuQm9keS52ZWxvY2l0eS5TZXQoIHN0aWNrcy5MZWZ0U3RpY2suaG9yaXpvbnRhbEF4aXMsIHN0aWNrcy5MZWZ0U3RpY2sudmVydGljYWxBeGlzIClcclxuICAgICAgICBAdGFuay5Cb2R5LnZlbG9jaXR5Lk11bHRpcGx5U2NhbGFyKCBAdGFuay5tb3ZlU3BlZWQgKVxyXG5cclxuICAgICAgICBpZiBAdGFuay5Cb2R5LnZlbG9jaXR5Lm1hZ25pdHVkZSA+IDBcclxuICAgICAgICAgICAgcm90YXRpb24gPSBAdGFuay5Cb2R5LnZlbG9jaXR5LmFuZ2xlICsgTWF0aC5QSSAvIDJcclxuXHJcbiAgICAgICAgQHRhbmsucm90YXRpb24gPSByb3RhdGlvblxyXG5cclxuICAgIFVwZGF0ZUJhcnJlbDogLT5cclxuICAgICAgICByb3RhdGlvbiA9IEB0YW5rLmJhcnJlbC5yb3RhdGlvblxyXG5cclxuICAgICAgICBpZiBNYXRoLmFicyhAZ2FtZVBhZC5zdGlja3MuUmlnaHRTdGljay52ZXJ0aWNhbEF4aXMpID4gMCBvciBNYXRoLmFicyhAZ2FtZVBhZC5zdGlja3MuUmlnaHRTdGljay5ob3Jpem9udGFsQXhpcykgPiAwXHJcbiAgICAgICAgICAgIHJvdGF0aW9uID0gTWF0aC5hdGFuMiggQGdhbWVQYWQuc3RpY2tzLlJpZ2h0U3RpY2sudmVydGljYWxBeGlzLCBAZ2FtZVBhZC5zdGlja3MuUmlnaHRTdGljay5ob3Jpem9udGFsQXhpcyApXHJcbiAgICAgICAgICAgIHJvdGF0aW9uICs9IE1hdGguUEkgLyAyXHJcblxyXG4gICAgICAgIEB0YW5rLmJhcnJlbC5yb3RhdGlvbiA9IHJvdGF0aW9uXHJcblxyXG4gICAgVXBkYXRlU2hvb3Rpbmc6IC0+XHJcbiAgICAgICAgZ2FtZSA9IEB0YW5rLmdhbWVcclxuICAgICAgICBpZiBAZ2FtZVBhZC5idXR0b25zLlJpZ2h0VHJpZ2dlci5kb3duIGFuZCAoIGdhbWUudGltZSAtIEB0aW1lc3RhbXBfYnVsbGV0RmlyZWQgKSA+IDQwMFxyXG4gICAgICAgICAgICBAdGltZXN0YW1wX2J1bGxldEZpcmVkID0gZ2FtZS50aW1lXHJcbiAgICAgICAgICAgIEB0YW5rLlNob290KClcclxuIl19
//# sourceURL=C:\dev\Torch\Games\TankyTanks\Src\Controller.coffee